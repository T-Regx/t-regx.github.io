<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.75">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="T-Regx Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="T-Regx Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="T-Regx" href="/opensearch.xml">
<script src="https://buttons.github.io/buttons.js"></script><title data-react-helmet="true">Prepared Patterns - Introduction | T-Regx</title><meta data-react-helmet="true" property="og:url" content="https://t-regx.com/docs/prepared-patterns"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Prepared Patterns - Introduction | T-Regx"><meta data-react-helmet="true" name="description" content="Documentation for version: 0.41.2"><meta data-react-helmet="true" property="og:description" content="Documentation for version: 0.41.2"><meta data-react-helmet="true" property="og:image" content="https://t-regx.com/img/t.regx.png"><meta data-react-helmet="true" name="twitter:image" content="https://t-regx.com/img/t.regx.png"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://t-regx.com/docs/prepared-patterns"><link data-react-helmet="true" rel="alternate" href="https://t-regx.com/docs/prepared-patterns" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://t-regx.com/docs/prepared-patterns" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.328cfba7.css">
<link rel="preload" href="/assets/js/runtime~main.b86eb2c2.js" as="script">
<link rel="preload" href="/assets/js/main.1467f67c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/t.regx.borderless.png" alt="T-Regx" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/t.regx.borderless.png" alt="T-Regx" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><strong class="navbar__title">T-Regx</strong></a><a class="navbar__item navbar__link" href="/docs/overview">Tutorial</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/comparison">Compare</a><a class="navbar__item navbar__link" href="/help">Help</a><a class="navbar__item navbar__link" href="/replit">Try online</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/T-Regx/T-Regx/blob/develop/ChangeLog.md" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">ChangeLog</a><a href="https://github.com/T-Regx/T-Regx" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_cxYs react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/t.regx.borderless.png" alt="T-Regx" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/t.regx.borderless.png" alt="T-Regx" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><strong class="navbar__title">T-Regx</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/overview">Tutorial</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a class="menu__link" href="/comparison">Compare</a></li><li class="menu__list-item"><a class="menu__link" href="/help">Help</a></li><li class="menu__list-item"><a class="menu__link" href="/replit">Try online</a></li><li class="menu__list-item"><a href="https://github.com/T-Regx/T-Regx/blob/develop/ChangeLog.md" target="_blank" rel="noopener noreferrer" class="menu__link">ChangeLog</a></li><li class="menu__list-item"><a href="https://github.com/T-Regx/T-Regx" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_lDyR"><div class="docSidebarContainer_0YBq" role="complementary"><div class="sidebar_a3j0"><div class="menu menu--responsive thin-scrollbar menu_cyFh"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_iZzd" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menuLinkText_lRH+">About</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview">What&#x27;s T-Regx?</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_lRH+">Kick Start</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/installation">Installation</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_lRH+">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/introduction">Introduction to T-Regx</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/introduction-preg">Summary of preg methods</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_lRH+">Matching</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/match">Matching overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/match-first">First occurrence</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/match-for-each">Iterating matches</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/match-map">Map occurrences</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/match-flat-map">Map with keys (Flat map)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/count">Counting occurrences</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_lRH+">Match Details</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/match-details">Match details</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/match-groups">Capturing groups</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/match-offsets">Match offsets</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/match-as-int">Handling integers</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_lRH+">Replacing</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/replace">Replacing a string</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/replace-with">Replace with a constant value</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/replace-callback">Replace with callback</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_lRH+">Prepared Patterns</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/prepared-patterns">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/template-syntax">Template Syntax</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_lRH+">Misc</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pattern-list">Multiple patterns</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/delimiters">Automatic delimiters</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/split">Split a string</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/filter">Filtering an array</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/match-iterator">Iterator</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_lRH+">Exceptions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/exception-structure">Exceptions overview</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_lRH+">Advanced</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/match-groups-in-depth">Capturing groups - in depth</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/match-groups-j-modifier">Capturing groups - J modifier</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_lRH+">PHP Hate</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/why-php-sucks">Why PHP sucks?</a></li></ul></li></ul></div></div></div><main class="docMainContainer_r8cw"><div class="container padding-vert--lg docItemWrapper_NJLN"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><header><h1 class="docTitle_-X99">Prepared Patterns - Introduction</h1></header><div class="markdown"><p>Documentation for version: 0.41.2</p><p>When arbitrary value is needed in the pattern, it might be tempting to use simple string concatenation.
However, integration of dynamic values such as <code>$_GET[&#x27;domain&#x27;]</code> can be troublesome or even dangerous.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><div tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:rgb(191, 199, 213);background-color:rgb(41, 45, 62)"><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">Pattern::of(&#x27;^https://&#x27; . $_GET[&#x27;domain&#x27;] . &#x27;\.(com|net)&#x27;);  // risky and dangerous</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>But you, dear reader, know that&#x27;s a terrible, terrible idea. <code>$_GET[&#x27;domain&#x27;]</code> may contain
unexpected/malicious regular expression special characters, which at best will match incorrect
characters, malform the pattern completely, or in the worse case - open the door to ReDos attack.</p><p>Potential risks include:</p><ul><li>Complex look-aheads and look-arounds (<code>(?!&lt;</code>)</li><li>Recursive patterns (<code>(?R)</code>)</li><li>Structures prone to catastrophic backtracking</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="introduction"></a>Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">#</a></h2><p>Prepared patterns is T-Regx solution for using arbitrary, dynamic values that need to be
integrated into the regular expression. <code>Pattern</code> instantiated with prepared patterns
are safely constructed. Such construction alleviates the dangers of ReDos attacks and
improper regular expression syntax.</p><p>The idea is very similar to prepared statements from SQL world, in which many SQL statements
suffer from a very similar issue, yet in that case the trouble is either improper SQL syntax
or even SQL-Injection vulnerability. Despite being utterly different technologies, both ReDos
and SQL-Injection vulnerabilities come from the same error - improper integration of language
(Regexp and SQL) and arbitrary parameters passed into it.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="regular-expression-template"></a>Regular expression template<a class="hash-link" href="#regular-expression-template" title="Direct link to heading">#</a></h3><p>In order to safely integrate dynamic or unsafe values into the regular expression, special
character <code>@</code> must be used in the expression as a <em>placeholder</em>. The <code>@</code> placeholder behaves
like a standard regular expression figure, and matches whatever characters or figures are
bound to it when prepared pattern is instantiated.</p><p>The placeholder <code>@</code> matches a literal value (<code>string</code>), an alteration of values or more
complex structures, such as other patterns or masks, depending on what <em>figure</em> exactly was
bound to the particular <em>placeholder</em>. First, let&#x27;s take a look at literal values.</p><p>Looking at the previous example, the initial regular expression is improperly constructed by
string concatenation.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><div tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:rgb(191, 199, 213);background-color:rgb(41, 45, 62)"><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">$input = $_GET[&#x27;name&#x27;];</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">Pattern::of(&quot;(My|Our) dog&#x27;s name is &quot; . $input . &#x27;!&#x27;);  // improper and risky</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Naive string concatenation is risky for various reasons. Let us use <code>Pattern::inject()</code>, instead.</p><p>Instead of concatenating with <code>$input</code>, let&#x27;s add <em>placeholder</em> <code>@</code> into the regular expression,
and bind <code>$input</code> <em>figure</em> to it. The placeholder <code>@</code> used in the regular expression will match
whatever characters or figures are bound to it. With <code>Pattern::inject()</code>, the bound values
(called <em>figures</em>) are supposed to be passed as an <code>array</code>, as the second argument of <code>Pattern::inject()</code>.</p><p>In T-Regx terminology, a <em>figure</em> is whatever is being matched by <em>placeholder</em> <code>@</code>. Scroll down,
to read more about <a href="#terminology">Terminology</a>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><div tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:rgb(191, 199, 213);background-color:rgb(41, 45, 62)"><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">$input = $_GET[&#x27;name&#x27;];</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">$pattern = Pattern::inject(&quot;(My|Our) dog&#x27;s name is @!&quot;, [$input]);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Using regular expressions with <code>@</code> placeholder and binding figures to it is the recommended
approach, instead of naive string concatenation.</p><p>Entry point <code>Pattern::inject()</code> returns an instance of <code>Pattern</code>, exactly like <code>Pattern::of()</code>,
so the interface of the <code>Pattern</code> is exactly the same.</p><p>Following the example above: <code>Pattern::inject(&quot;(My|Our) dog&#x27;s name is @!&quot;, [$input])</code>, we find
that the <code>Pattern</code> will match: one of <code>&quot;My&quot;</code> or <code>&quot;Our&quot;</code>, then string <code>&quot; dog&#x27;s name is &quot;</code> literally,
then whatever was passed in <code>$_GET[&#x27;name&#x27;]</code>, and then <code>&quot;!&quot;</code> literally. Any regular expression
characters, such as <code>.</code>, <code>?</code>, <code>(</code>, <code>)</code> that are potentially present in <code>$_GET[&#x27;name&#x27;]</code> will be
matched literally, not as a regular expression. This is the main reason why Prepared Patterns
alleviate risks of malformed patterns and ReDos attacks.</p><p>Should two values be required in the pattern - a <em>template</em> with two <code>@</code> placeholders must be
used, and two <em>figures</em> must be passed as the second argument.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><div tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:rgb(191, 199, 213);background-color:rgb(41, 45, 62)"><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">$start = $_GET[&#x27;start&#x27;];</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">$end = $_GET[&#x27;end&#x27;];</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">$pattern = Pattern::inject(&quot;^@:\w+?:@$&quot;, [$start, $end]);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>The number of <code>@</code> <em>placeholders</em> in the <em>template</em> and the number of <em>figures</em> bound must be
equal. When too many or too little <em>figures</em> is bound to the <em>template</em>, <code>PlaceholderFigureException</code>
is thrown and instantiation of <code>Pattern</code> fails.</p><p>Close examination of the constructed <code>Pattern</code> can be done by casting the resulting <code>Pattern</code>
to <code>string</code>. Casting any instance of <code>Pattern</code>, regardless of whether it was created with <code>Pattern::of()</code>,
<code>Pattern::inject()</code> or any other entry point, results in a delimited regular expression.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><div tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:rgb(191, 199, 213);background-color:rgb(41, 45, 62)"><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">/* Pass a potentially unsafe string */</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">$input = &quot;w.w?&quot;;</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">/* Safely instantiate the pattern */</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">$pattern = Pattern::inject(&quot;^&#x27;@!+$&quot;, [$input]);</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">/* Examine the constructed regular expression */</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">$regularExpression = (string) $pattern;</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">/* Render the regular expression, for debugging purposes */</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">echo $regularExpression;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><div tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:rgb(191, 199, 213);background-color:rgb(41, 45, 62)"><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">/^&#x27;w\.w\?!+$/</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>When examining the constructed regular expression from <code>Pattern</code>, you will notice that special
characters <code>.</code> and <code>?</code> used in <code>&quot;w.w?&quot;</code> are represented as escaped characters <code>\.</code> and <code>\?</code> in
the regular expression.</p><p>More details on placeholder <code>@</code> syntax can be found in the next chapter: <a href="/docs/template-syntax">Template Syntax</a>.
Also, scroll to <a href="#frequently-asked-questions">FAQ</a> for the most common questions.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="conditional-placeholders"></a>Conditional placeholders<a class="hash-link" href="#conditional-placeholders" title="Direct link to heading">#</a></h3><p>Placeholder <code>@</code> in <em>template</em> behaves like all other regular expression figures, so expression
<code>@?</code> is an optional placeholder, which matches an optional bound figure. Of course, other
quantifiers such as <code>*</code> and <code>+</code> are also allowed, for example <code>@*</code> and <code>@+</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><div tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:rgb(191, 199, 213);background-color:rgb(41, 45, 62)"><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">$directory = &quot;home_folder&quot;;</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">$filename = &quot;image.jpg&quot;;</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">$directoryPattern = Pattern::inject(&quot;^/@/@?$&quot;, [$directory, $filename]);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Notice, that the second placeholder <code>@?</code> matches optionally, due to it being followed by the
wildcard <code>?</code>, by regular expression. Because of that, <code>$directoryPattern</code> will match either
<code>&quot;/home_folder/&quot;</code> or <code>&quot;/home_folder/image.jpg&quot;</code>. Note for curious readers - it will not match
<code>&quot;/home_folder/image.jp&quot;</code>.</p><p>By regular expression, <code>@?</code> matches the figures greedily. Analyzing the <em>template</em>, we see:
assertion <code>^</code> matches the start of the subject, <code>/</code> matches character <code>&quot;/&quot;</code> literally,
the first placeholder <code>@</code> matches <em>figure</em> <code>&quot;home_folder&quot;</code>, then <code>/</code> matches <code>&quot;/&quot;</code>, then
the second placeholder <code>@</code> matches <code>&quot;image.jpg&quot;</code> literally, greedy quantifier <code>?</code> means the
previous token (which is <code>@</code>) matches 0 or 1 time, as much as possible, which means <code>@?</code>
matches either <code>&quot;image.jpg&quot;</code> or nothing at all; and finally assertion <code>$</code> matches the end of
subject.</p><p>To conditionally match a placeholder, but not greedily, the placeholder should be followed
by <code>??</code>, by regular expression.</p><p>It&#x27;s worth to mention, that regardless of the quantifier used for the <em>placeholder</em>, the figure
must still be bound for the placeholder. Omitting the figure in the <code>Pattern::inject()</code>, while
a valid <code>@</code> placeholder is used in the <em>template</em>, even followed by <code>?</code>, is disallowed.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><div tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:rgb(191, 199, 213);background-color:rgb(41, 45, 62)"><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">Pattern::inject(&quot;^/@/@?$&quot;, [$directory]);  // throws PlaceholderFigureException</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>In other words, <em>template</em> <code>^/@/@?$</code> consists of two placeholders, and thus two bound <em>figures</em>
are required.</p><p>More details on usage of <code>@</code> <em>placeholder</em> in the <em>template</em> be found in the next chapter:
<a href="/docs/template-syntax">Template Syntax</a>. Also, scroll to <a href="#frequently-asked-questions">FAQ</a> for
the most common questions.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="pre-compiling-templates"></a>Pre-compiling templates<a class="hash-link" href="#pre-compiling-templates" title="Direct link to heading">#</a></h2><p>A quite popular use-case of prepared patterns appears when a single <em>template</em> should be used
to instantiate multiple instances of <code>Pattern</code> with different bound <em>figures</em>. <code>Pattern::template()</code>
accepts a regular expression with placeholders, but without any bound figures. Afterwards, at
a later stage, a new pattern can be instantiated from the template, with bound <em>figures</em>.
<code>Pattern::template()</code> accepts a single <em>placeholder</em> in the template, as opposed to <code>Pattern::builder()</code>,
which accepts varying number of <em>placeholders</em>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><div tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:rgb(191, 199, 213);background-color:rgb(41, 45, 62)"><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">/* Create your template */</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">$template = Pattern::template(&#x27;^(my|your):@$&#x27;);</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">/* Instantiate the pattern */</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">$pattern1 = $template-&gt;literal($_GET[&#x27;value1&#x27;]);</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">$pattern2 = $template-&gt;literal($_GET[&#x27;value2&#x27;]);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Modifiers can be passed as the second argument in <code>Pattern::template()</code>, for example <code>Pattern::template(&#x27;^(my|your):@$&#x27;, &#x27;i&#x27;)</code>.</p><p>Using <code>Pattern::template()</code> has the added advantage of parsing and compiling the pattern early,
and deferring binding of the <em>figures</em> for the later time. A common use-case is instantiating
<code>Pattern::template()</code> in a constructor of your domain class, and only binding the <em>figure</em> in
the instance method. Perhaps the method argument can be bound as a <em>figure</em>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><div tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:rgb(191, 199, 213);background-color:rgb(41, 45, 62)"><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">class Checker {</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">  private Template $template;</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">  </span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">  public function __construct() {</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">    $this-&gt;template = Pattern::template(&#x27;^word:@$&#x27;);</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">  </span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">  public function test(string $word, string $subject): bool {</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">    $pattern = $this-&gt;template-&gt;literal($word);</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">    return $pattern-&gt;test($subject);</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>If multiple patterns are only different in the values they bind, it&#x27;s recommended to create a
template earlier, and insert the exact values in the later stage. Instantiating a new pattern
each time can be wasteful for big regular expressions:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><div tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:rgb(191, 199, 213);background-color:rgb(41, 45, 62)"><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">foreach ($values as $value) {</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">  $pattern = Pattern::inject(&#x27;^@$&#x27;, [$value]);  // expensive</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>compared to creating the template first:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><div tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:rgb(191, 199, 213);background-color:rgb(41, 45, 62)"><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">$template = Pattern::template(&#x27;^@$&#x27;); // construct once</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">foreach ($values as $value) {</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">  $pattern = $template-&gt;literal($value);  // optimal</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>This is not to say <code>Pattern::inject()</code> is not to be used. If a certain <em>template</em> is only going
to be used once, then pre-compiling it with <code>Pattern::template()</code> doesn&#x27;t yield any performance
gain and <code>Pattern::inject()</code> is equally viable. On the other hand, using <code>Pattern::template()</code>
can still be beneficial to compile the template early, rather than later, for example in the
domain class constructor.</p><p><code>Pattern::template()</code> is a shorthand interface for <code>Pattern::builder()</code>. <code>Pattern::builder()</code>
exposes an interface which binds multiple figures. Final call to <code>bind()</code> instantiates the
constructed <code>Pattern</code>. <code>Pattern::template()</code> is a shorthand, which only accepts a single bound
figure, yet it is completely sufficient, as <code>Pattern::template()</code> covers 95% of prepared pattern
use-cases.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="pre-compiling-templates-with-multiple-figures"></a>Pre-compiling templates with multiple figures<a class="hash-link" href="#pre-compiling-templates-with-multiple-figures" title="Direct link to heading">#</a></h3><p>Binding a single <em>figure</em> into the <em>template</em> is the majority of use cases. Should that not be
the case, <code>Pattern::builder()</code> can be used to bind multiple values and also allows to construct
the template early. The word &quot;builder&quot; in <code>Pattern::builder()</code> refers to <code>TemplateBuilder</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><div tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:rgb(191, 199, 213);background-color:rgb(41, 45, 62)"><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">/* Create your template with builder */</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">$template = Pattern::builder(&#x27;^(my|your):@:@$&#x27;);</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">/* Instantiate the pattern */</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">$pattern = $template-&gt;literal($_GET[&#x27;first&#x27;])-&gt;literal($_GET[&#x27;second&#x27;])-&gt;build();</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>The number of <em>placeholders</em> <code>@</code> in the <em>template</em> and the number of chained <code>literal()</code> calls
must be equal. When too many or too little <em>figures</em> is bound into the <em>template</em>, <code>PlaceholderFigureException</code>
is thrown and instantiation of <code>Pattern</code> fails.</p><p>Calling <code>Pattern::builder()</code> and only using a single <code>-&gt;literal()</code> is in fact identical to calling
<code>Pattern::template()-&gt;literal()</code>.</p><p>Let&#x27;s take a look at the example above, but with <code>TemplateBuilder</code> used, instead of previous <code>Template</code>,
so that the <em>template</em> can consist of two <code>@</code> placeholders, with one figure being bound in the
constructor, and the second in the instance method.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><div tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:rgb(191, 199, 213);background-color:rgb(41, 45, 62)"><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">class Checker {</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">  private TemplateBuilder $template;</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">  </span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">  public function __construct(string $first) {</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">    $this-&gt;template = Pattern::builder(&#x27;^@:@$&#x27;)-&gt;literal($first);</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">  </span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">  public function test(string $second, string $subject): bool {</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">    $pattern = $this-&gt;template-&gt;literal($word)-&gt;build();</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">    return $pattern-&gt;test($subject);</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Calls to <code>-&gt;literal()</code> can be safely refactored, since <code>Pattern::builder()</code> is immutable.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="pcre-styled-patterns"></a>PCRE-styled patterns<a class="hash-link" href="#pcre-styled-patterns" title="Direct link to heading">#</a></h2><p>Should there be a need for your own delimiters, <code>PcrePattern</code> can be used. <code>PcrePattern</code> offers
similar entry points (<code>PcrePattern::of()</code>, <code>PcrePattern::inject()</code>, <code>PcrePattern::list()</code>), with
the difference that the regular expressions must already be delimited and have their modifiers
appended. <code>PcrePatterns</code> still accepts <em>placeholders</em> <code>@</code> in their templates, for example with
<code>PcrePattern::template()</code>.</p><p>Example of <code>PcrePattern::inject()</code>, with pcre-styled <em>template</em> and <em>figure</em> containing the delimiter <code>%</code>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><div tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:rgb(191, 199, 213);background-color:rgb(41, 45, 62)"><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">$linkPattern = PcrePattern::inject(&quot;%https?://@/index\.php%m&quot;, [&#x27;one%two&#x27;]);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Pattern <code>$linkPattern</code> can be analyzed: <code>%</code> is a delimiter stating the start of PCRE regular
expression, <code>http</code> matches <code>&quot;http&quot;</code>, <code>s?</code> matches either <code>&quot;s&quot;</code> or nothing at all, <code>://</code> matches
<code>&quot;://&quot;</code>, placeholder <code>@</code> matches <code>&quot;one%two&quot;</code> literally, <code>index</code> matches <code>&quot;index&quot;</code>, escaped <code>\.</code>
matches <code>&quot;.&quot;</code>, <code>php</code> matches <code>&quot;php&quot;</code>, final <code>%</code> states the end of regular expression, <code>m</code> is a modifier.</p><p>Corresponding methods <code>PcrePattern::template()</code> and <code>PcrePattern::builder()</code> work accordingly.</p><p><code>PcrePattern</code> entry points return instance of <code>Pattern</code>, so the resulting pattern can be used as
any other T-Regx <code>Pattern</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="frequently-asked-questions"></a>Frequently asked questions<a class="hash-link" href="#frequently-asked-questions" title="Direct link to heading">#</a></h2><ul><li><p>How do I pass modifiers (flags) into <code>Pattern::inject()</code> and other entry points?</p><ul><li><p>Modifiers can be passed as the third argument in <code>Pattern::inject()</code>. For example, passing <code>i</code> (case-insensitive) modifier:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><div tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:rgb(191, 199, 213);background-color:rgb(41, 45, 62)"><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">Pattern::inject(&#x27;^@$&#x27;, [$input], &#x27;i&#x27;);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Remaining entry points accept modifiers as the second argument:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><div tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:rgb(191, 199, 213);background-color:rgb(41, 45, 62)"><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">Pattern::template(&#x27;^@$&#x27;, &#x27;i&#x27;);</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">Pattern::builder(&#x27;^@$&#x27;, &#x27;i&#x27;);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div></li></ul></li><li><p>Is passing an empty <code>string</code> as <em>figure</em> allowed?</p><ul><li><p>Yes - absolutely, an empty string is a perfectly valid <em>figure</em>. For example, template <code>&lt;@&gt;</code> with
bound <em>figure</em> of an empty string: <code>Pattern::inject(&#x27;&lt;@&gt;&#x27;, [&quot;&quot;])</code> - matches string <code>&quot;&lt;&gt;&quot;</code> just fine.</p><p>Furthermore, placeholders <code>@?</code> with quantifiers also work with empty strings. For example:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><div tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:rgb(191, 199, 213);background-color:rgb(41, 45, 62)"><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">$wordPattern = Pattern::inject(&quot;^word:@?$&quot;, [&quot;&quot;]);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>In this example, <code>$wordPattern</code> matches subject <code>&quot;word:&quot;</code>, but not <code>&quot;word&quot;</code>. For the pattern to match
<code>&quot;word&quot;</code>, an alternative template is needed, namely: <code>^word(:@)?$</code>.</p><p>In other words, if the bound <em>figure</em> matches 0 characters, by regular expression, so does the
corresponding <code>@</code> placeholder.</p></li></ul></li><li><p>Is passing an empty <code>array</code> of figures to <code>Pattern::inject()</code> allowed?</p><ul><li><p>If the <em>template</em> doesn&#x27;t contain any <em>placeholders</em> <code>@</code>, then actually an empty
<code>array</code> is the only allowed input, although it&#x27;s identical to simply calling <code>Pattern::of()</code>.</p><p>By analogy, the same applies to <code>Pattern::builder()</code>. When <em>template</em> doesn&#x27;t contain any <code>@</code>
placeholder, then no chain of <code>-&gt;literal()</code> is allowed before <code>-&gt;bind()</code>. Needless to say,
such construct is identical to <code>Pattern::of()</code> and is only present in the API for completeness.</p></li></ul></li><li><p>Is <code>Pattern::of($p)</code> identical to <code>Pattern::inject($p, [])</code>?</p><ul><li>Yes, provided that <code>$p</code> doesn&#x27;t contain unescaped <code>@</code> special character (which would be
a <em>placeholder</em> in <code>Pattern::inject()</code>).</li></ul></li><li><p>How can character <code>&quot;@&quot;</code> be used literally in the pattern?</p><ul><li><p>Escaped character <code>\@</code> is not treated as a placeholder, for example:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><div tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:rgb(191, 199, 213);background-color:rgb(41, 45, 62)"><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">$username = &quot;mark&quot;;</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">$mailPattern = Pattern::inject(&quot;@\@gmail.com&quot;, [$username]);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>In the example above, <code>Pattern</code> in <code>$mailPattern</code> matches subject <code>&quot;mark@gmail.com&quot;</code>.</p><p>More details on when exactly <code>@</code> is a <em>placeholder</em> can be found in the next chapter:
<a href="/docs/template-syntax">Template Syntax</a>.</p></li></ul></li></ul><ul><li><p>What happens when I pass string <code>&quot;@&quot;</code> as a figure. Will it recurse placeholders?</p><ul><li>No, character <code>&quot;@&quot;</code> passed as a figure will be treated as another literal, for example:<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><div tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:rgb(191, 199, 213);background-color:rgb(41, 45, 62)"><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">Pattern::inject(&#x27;^@:@$&#x27;, [&#x27;word&#x27;, &#x27;@&#x27;]);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div>Instance of the <code>Pattern</code> above will match subject <code>&quot;word:@&quot;</code>, though it won&#x27;t construct
optimal regular expression. Escaping the <code>@</code> character is the recommended approach:<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><div tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:rgb(191, 199, 213);background-color:rgb(41, 45, 62)"><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">Pattern::inject(&#x27;^@:@$&#x27;, [&#x27;word&#x27;, &#x27;@&#x27;]);  // not optimal</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">Pattern::inject(&#x27;^@:\@$&#x27;, [&#x27;word&#x27;]);      // optimal</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div>Escaping <code>@</code> character is not only optimal performance-wise, but is also more readable.</li></ul></li><li><p>Can figures influence the construction of the <code>Pattern</code>, for example by taking part in
the selection of the delimiter?</p><ul><li><p>No, the <em>template</em> is assigned a delimiter regardless of the <em>figures</em> bound to it.
For example:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><div tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:rgb(191, 199, 213);background-color:rgb(41, 45, 62)"><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">$value = &quot;/&quot;; // slash, a standard delimiter</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">/* Render the regular expression, for debugging purposes */</span></div><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">echo (string) Pattern::inject(&#x27;^@$&#x27;, [$value]); </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>constructs a pattern with standard <code>/</code> delimiter, with figure <code>&quot;/&quot;</code> being properly escaped:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><div tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:rgb(191, 199, 213);background-color:rgb(41, 45, 62)"><div class="token-line" style="color:rgb(191, 199, 213)"><span class="token plain">/^\/$/</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div></li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="what-about-special-cases"></a>What about special cases<a class="hash-link" href="#what-about-special-cases" title="Direct link to heading">#</a></h2><p>T-Regx prepared patterns understand that sometimes <code>@</code> figure shouldn&#x27;t be a placeholder, even
when using <code>Pattern::inject()</code> or <code>Pattern::template()</code>. </p><p>Structures, in which character <code>@</code> is <strong>not</strong> a <em>placeholder</em> (matches <code>&quot;@&quot;</code> literally): </p><ul><li>Escaped character: <code>\w+:\@</code></li><li>Character class: <code>\w+:[0-9@]</code></li><li>Perl quote: <code>\w+:\Q@\E</code></li><li>Control character: <code>\w+:\c@</code></li><li>Comment group: <code>\w(?#comment@)</code></li><li>Comment (when <code>x</code> flag is used): <code>\w+:#@\n</code></li></ul><p>Other cases, when <code>@</code> placeholder can be used are:</p><ul><li>Capturing groups: <code>(word:@)</code> (figure bound to <code>@</code> is captured)</li><li>Non-capturing groups: <code>(?:word:@)</code> (figure bound to <code>@</code> is <strong>not</strong> captured)</li><li>Atomic capturing groups: <code>(?&gt;word:@)</code></li><li>Look-aheads: <code>(?=&quot;@&quot;)</code></li><li>Look-behinds: <code>(?&lt;=&quot;@&quot;)</code></li></ul><p>More details on when exactly <code>@</code> is a <em>placeholder</em> can be found in the next chapter: <a href="/docs/template-syntax">Template Syntax</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="terminology"></a>Terminology<a class="hash-link" href="#terminology" title="Direct link to heading">#</a></h2><p>There are 4 new terms introduced with prepared patterns in this chapter: &quot;Prepared patterns&quot;, &quot;template&quot;,
&quot;placeholder&quot; and &quot;figure&quot;.</p><ul><li><p>&quot;Prepared patterns&quot; is a common name for the interface for safe construction of instances of <code>Pattern</code> with arbitrary
values (like dynamic strings). In this documentation, entry points <code>Pattern::inject()</code> and <code>Pattern::template()</code>
are referred to as &quot;prepared patterns&quot;. In other words, &quot;prepared patterns&quot; are patterns with <code>@</code> placeholder
in them.</p><p><code>Pattern::of()</code> is not referred to as &quot;prepared pattern&quot;, because while character <code>&quot;@&quot;</code> can very well
be used in the regular expression with <code>of()</code> (for example <code>Pattern::of(&#x27;\w+@\w+.\w+&#x27;)</code>), it is not a
placeholder. Character <code>&quot;@&quot;</code> used in <code>Pattern::of()</code> matches character <code>&quot;@&quot;</code> literally, where-as
placeholders <code>@</code> in <code>Pattern::inject()</code> and <code>Pattern:template()</code> will match the values that will have
been bound to them.</p><p>More details on when exactly <code>@</code> is a <em>placeholder</em> can be found in the next chapter:
<a href="/docs/template-syntax">Template Syntax</a>.</p></li><li><p>&quot;template&quot; is a name for a regular expression that contains <code>@</code> <em>placeholder</em> in it, and can later
be bound to certain <em>figures</em> or character which will match in place of <code>@</code> <em>placeholder</em>. Entry
points <code>Pattern::inject()</code> and <code>Pattern::template()</code> accept <em>template</em> as their first argument.</p><p>More details on when exactly <code>@</code> is a <em>placeholder</em> can be found in the next chapter:
<a href="/docs/template-syntax">Template Syntax</a>.</p></li><li><p>&quot;placeholder&quot; is a name for a figure <code>@</code> appearing in a <em>template</em>. Not every occurrence of <code>@</code>
in a regular expression is a <em>placeholder</em>. For example, escaped <code>\@</code> is not a <em>placeholder</em>,
and so will match character <code>&quot;@&quot;</code> literally.</p><p>More details on when exactly <code>@</code> is a <em>placeholder</em> can be found in the next chapter:
<a href="/docs/template-syntax">Template Syntax</a>.</p></li><li><p>&quot;figure&quot; is a name for anything that can be bound to a <em>placeholder</em>, most common of which is
a literal <code>string</code>, but can also be an alteration, another pattern or a mask.</p></li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"></div><div class="col text--right"><em><small>Last updated on <time datetime="2023-02-05T16:13:23.000Z" class="lastUpdatedDate_nN9m">2/5/2023</time></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/replace-callback"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Replace with callback</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/template-syntax"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Template Syntax Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link">Introduction</a><ul><li><a href="#regular-expression-template" class="table-of-contents__link">Regular expression template</a></li><li><a href="#conditional-placeholders" class="table-of-contents__link">Conditional placeholders</a></li></ul></li><li><a href="#pre-compiling-templates" class="table-of-contents__link">Pre-compiling templates</a><ul><li><a href="#pre-compiling-templates-with-multiple-figures" class="table-of-contents__link">Pre-compiling templates with multiple figures</a></li></ul></li><li><a href="#pcre-styled-patterns" class="table-of-contents__link">PCRE-styled patterns</a></li><li><a href="#frequently-asked-questions" class="table-of-contents__link">Frequently asked questions</a></li><li><a href="#what-about-special-cases" class="table-of-contents__link">What about special cases</a></li><li><a href="#terminology" class="table-of-contents__link">Terminology</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/installation">Installation</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/introduction-preg">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/match">Documentation</a></li><li class="footer__item"><a href="https://github.com/T-Regx/T-Regx/blob/develop/ChangeLog.md" target="_blank" rel="noopener noreferrer" class="footer__link-item">API Reference</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/T-Regx/T-Regx" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a class="github-button" href="https://github.com/T-Regx/T-Regx" title="See this project on GitHub" data-icon="octicon-star" data-show-count="true" data-count-href="/T-Regx/T-Regx/stargazers" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">T-Regx</a></li><li class="footer__item"><a href="https://github.com/sponsors/Danon" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sponsor</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/t.regx.png" alt="T-Regx" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/img/t.regx.png" alt="T-Regx" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></div><div class="footer__copyright">Copyright Â© 2017-2023 Daniel Wilkowski</div></div></div></footer></div>
<script src="/assets/js/runtime~main.b86eb2c2.js"></script>
<script src="/assets/js/main.1467f67c.js"></script>
</body>
</html>