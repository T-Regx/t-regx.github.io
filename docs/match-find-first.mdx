---
id: match-find-first
title: Optional matches (Find first)
---

import {CodeTabs, Result} from './code';

If you call [`first()`] on a subject that isn't matched by a pattern - `SubjectNotMatchedException` is
thrown. We discussed that in the previous chapter.

But what if you **expected** the subject not to be matched? And how do you to react to it? 

## Optional matches with `findFirst()`

Method `findFirst()` can be called with a callback (that accepts [`Detail`]) just like [`first()`].
The difference is: `findFirst()` never throws `SubjectNotMatchedException`, and allows you to control an unmatched subject by
appropriate control methods: `orThrow()`, `orReturn()` and `orElse()`.

For example:

<CodeTabs
    tregx={`return pattern('[0-9]+')->match("I'm 19 years old")
   ->findFirst()
   ->map(function (Detail $match) {
       // highlight-next-line
       return "I was born $match years ago";
   })
   ->orReturn('Unmatched :/');`}
    php={`if (preg::match('/[0-9]+/', "I'm 19 years old", $match)) {
    $text = $match[0];
    // highlight-next-line
    return "I was born $text years ago";
}
return 'Unmatched :/';`}/>
<Result>'I was born 19 years ago'</Result>

If a match is found, then the result of `findFirst()` callback is returned. If a match is not found, however, then the 
handling of an unmatched subject lies in the chained method.

### `orReturn()`

If a match is not found, it returns a default value.

<CodeTabs
    tregx={`return pattern('[0-9]+')->match("I'm a dog")
    ->findFirst()
    ->map(function (Detail $match) {
       return "I was born $match years ago";
    })
    // highlight-next-line
    ->orReturn("Match is not found");`}
    php={`if (preg::match('/[0-9]+/', "I'm a dog", $match)) {
    $text = $match[0];
    return "I was born $text years ago";
}
// highlight-next-line
return "Match is not found";`}/>
<Result>'Match is not found'</Result>

### `orElse()`

If a match is not found, it calls `orElse()` callback and uses *it* to evaluate a return value.

<CodeTabs
    tregx={`return pattern('[0-9]+')->search("I'm a dog")
    ->findFirst()
    ->map(function (string $match) {
       return "I was born $match years ago";
    })
    ->orElse(function () {
        // highlight-next-line
        return "I couldn't match subject";
    });`}
    php={`$subject = "I'm a dog";
if (preg::match('/[0-9]+/', $subject, $match)) {
    $text = $match[0];
    return "I was born $text years ago";
}
// highlight-next-line
return "I couldn't match subject";`}/>
<Result>"I couldn't match subject"</Result>

### `orThrow()`

Returns the optional value, or throws the specified exception.

<CodeTabs
    tregx={`class MyException extends \\Exception {}\n
try {
    return pattern('[0-9]+')->match("I'm a dog")
        ->findFirst(function (Detail $detail) {
            return "Match is found!";
        })
        // highlight-next-line
        ->orThrow(new MyException());
}
catch (MyException $e) {
    // React to an unmatched subject
    echo "Not matched";
}`}
     php={`class MyException extends \\Exception {}\n
try {
    if (preg::match('/[0-9]+/', "I'm a dog")) {
        return "Match is found!";
    } 
    // highlight-next-line
    throw new MyException();
}
catch (MyException $e) {
    // React to an unmatched subject
    echo "Not matched";
}`}/>

[`first()`]: match-first.mdx
[`Detail`]: match-details.md
